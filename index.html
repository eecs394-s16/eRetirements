<html>
    <head>
        <title>Home</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <link href='https://fonts.googleapis.com/css?family=Hind:400,300' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="styles.css">

        <script src="./questionScript.js" type="text/javascript"></script>
        <script>
            var completed = 0;
            var modal;
        $(document).ready(function() {
            $('.Quiz').hide();
            var $completed = $('completed');

            $('.category').click(function(e) {
                var $clickedItem = $(e.target);
                var idName = jQuery(this).attr("id");
                showQuestion(idName);
                
            });
            
                    // Get the modal
modal = document.getElementById('myModal');

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}
        });
        var current = 1;
        var category;
		var completed_num = 0;
        console.log("start: completed_num :" + completed_num);
        var clickItem;
        var showQuestion = function(idName){
            $('.row').css("opacity","0.5");
            $('.Quiz').show();
            category = idName;
            current = 1;
            completed_num = 0;
            changeQuestion(category);
			var questionAndAnswers = categories[category];
            var total = questionAndAnswers.length;
			
			
			var strb ="";
			for(var i=0; i<total; i++)
			{
				var j =i+1;
				strb += "<div id='progressdiv"+j+"' class='progressdiv'>Q"+j+"</div>";
        	}

			$('#progress').html(strb);

            
        }
        var changeQuestionPrev = function() {
            current -= 1;
            var questionAndAnswers = categories[category];
            var total = questionAndAnswers.length;
            if(current < 1)
            {
                $('.Quiz').hide();
                $('.row').css("opacity","1");
            }
            else
            {
                console.log("here");
                changeQuestion(category);
            }

        }
        var changeQuestionSkip = function(){
			var str = "#progressdiv"+current;
            $(str).css({'background-color': 'yellow'});
            current += 1;
            var questionAndAnswers = categories[category];
            var total = questionAndAnswers.length;

             percent = (1-completed_num/total) * 100;
            if(current > total )
            {
                $("#" +category).css({'background-image':
                    'linear-gradient(to bottom, transparent '+ percent +'%, #90EE90 0)'});
                $("#" +category + " h3").html(completed_num +"/"+total);
                
//                 $("#" +category).find(".completed").css({'visibility': 'visible'});
//                 $("#" +category).css({'background-color': '#DCFDE1', 'border-color': '#DCFDE1'});
//                 $("#" +category).hover(function() {
//                         $("#" +category).css('border-color', '#6C9B74');
//                        }, function () {
//                         $("#" +category).css('border-color', '#DCFDE1');
//                    });
//                
                $('.Quiz').hide();
                $('.row').css("opacity","1");
            }
            else
			{
            	changeQuestion(category);
			}
        }
        
        var changeQuestionNext = function(){
            current += 1;
            completed +=1;
            completed_num +=1;
            if (completed == 10) {
                modal.style.display = "block";
                document.getElementById('results').disabled = false;
            }
            var questionAndAnswers = categories[category];
            var total = questionAndAnswers.length;
            if(current > total )
            {
                console.log("completed:" + completed_num);
                if(completed_num == total)
                {
                    // console.log("completed:" + completed);
                    $("#" +category).find(".completed").css({'visibility': 'visible'});
                }
                percent = (1-completed_num/total) * 100;
                console.log("percent:" +percent);
                 
                 // $("#" +category).css({'background-color': '#DCFDE1', 'border-color': '#DCFDE1'});
                 $("#" +category).css({'background-image':
                    'linear-gradient(to bottom, transparent '+ percent +'%, #90EE90 0)'});
                 $("#" +category + " h3").html(completed_num +"/"+total);
                 
                 $("#" +category).hover(function() {
                         $("#" +category).css('border-color', '#6C9B74');
                        }, function () {
                         $("#" +category).css('border-color', '#DCFDE1');
                    });
                
                $('.Quiz').hide();
                $('.row').css("opacity","1");
            }
            else
            changeQuestion(category);
            document.getElementById("next").disabled = true;
        }
        var changeQuestion = function(category){

            var questionAndAnswers = categories[category];
            var title;
            if (category == "location"){
              title = "Location & Weather"
            } else if (category == "community"){
              title = "Community & Demographics"
            } else if (category == "activities") {
              title = "Activities & Work Potential"
            } else if (category == "health") {
              title = "Health Care"
            } else if (category == "costs") {
              title = "Cost of Living"
            }
            document.getElementById("category_title").innerHTML = title;
            var total = questionAndAnswers.length;
            var currentQuestionAndAnswers = questionAndAnswers[current-1];
            $('#question_number').text( "Question " + current +" out of " + total);
            $('#question_content').text(currentQuestionAndAnswers["question"]);

            var answers = currentQuestionAndAnswers["answers"];
            var len = answers.length;
            var str = "";
            console.log();
            for(var i = 0; i < len; i++)
            {
				var j = i+1;
                str += "<li><button id='button"+j+"' class='list-group-item answer' style='border-radius:10px; text-align:center' onclick='focusButton("+j+","+len+")'>  " + answers[i] +
                "</button></li>";
            }
            $('#question_option').html(str);
			
			
			
			
		}
        
        var focusButton = function(j,len){
			var str = "#progressdiv"+current;
            $(str).css({'background-color': 'lightgreen'});
			for (i=1; i<=len; i++)
			{
				var str = "#button"+i;
				$(str).css({'background-color': 'white'});
			}
			var str = "#button"+j;
			$(str).css({'background-color': 'lightgreen'});
            document.getElementById("next").disabled = false;
        }
        </script>

    </head>
    <body>
        <center>
            <div id="question" class="Quiz">
                <div id="category_title">
                    Location Quiz
                </div>
                <div id="question_area">
                    <p id="question_number">
                    </p>
                    
                    <br>
                    <p id="question_content">
                    </p>
                    <ul class="list-group" id="question_option">
                    </ul>

                </div>
                <div id="progress"></div>
                <div id="button_area">
                    
                    
                    <button id="prev" onclick="changeQuestionPrev()" class="btn">prev</button>
                    <button id="skip" onclick="changeQuestionSkip()" class="btn">skip</button>
                    <button id="next" onclick="changeQuestionNext()" class="btn btn-success" disabled>next</button>
                    
                    
                </div>

            </div>

        <img src="navbar.png" alt="navbar" width=100%>
        <div class="row">
            <div id="location" class="category" >
                <br>
                <h2 id="titlename">Location &amp; Weather</h2>
                <h3 id="percentage">0/3</h3>
                <h1><i class="fa fa-sun-o" aria-hidden="true"></i></h1>
                <div class="completed">
                    <p><i class="fa fa-check fa-4x" aria-hidden="true"></i></p>
                </div>
            </div>

            <div id="community" class="category">
                <br>
                <h2 id="titlename">Community &amp; Demographics</h2>
                <h3 id="percentage">0/5</h3>
                <h1><i class="fa fa-users" aria-hidden="true"></i></h1>
                <div class="completed">
                    <p><i class="fa fa-check fa-4x" aria-hidden="true"></i></p>
                </div>
            </div>
            <div id="activities" class="category">
                <br>
                <h2 id="titlename">Activities &amp; Work Potential</h2>
                <h3 id="percentage">0/4</h3>
                <h1><i class="fa fa-bicycle" aria-hidden="true"></i></h1>
                <div class="completed">
                    <p><i class="fa fa-check fa-4x" aria-hidden="true"></i></p>
                </div>
            </div>
         </div>
        <div class="row">
            <div id="health" class="category">
                <br><h2 id="titlename">Health Care</h2>
                <h3 id="percentage">0/3</h3>
                <h1><i class="fa fa-medkit" aria-hidden="true"></i></h1>
                <div class="completed">
                    <p><i class="fa fa-check fa-4x" aria-hidden="true"></i></p>
                </div>
            </div>
            <div id="costs" class="category">
                <br>
                <h2 id="titlename">Cost of Living</h2>
                <h3 id="percentage">0/3</h3>
                <h1><i class="fa fa-usd" aria-hidden="true"></i></h1>
                <div class="completed">
                    <p><i class="fa fa-check fa-4x" aria-hidden="true"></i></p>
                </div>
            </div>

        </div>
            
        </center>

<a href="results.html"><button class="btn btn-lg btn-primary" disabled id="results">Results
<i class="fa fa-arrow-right" aria-hidden="true"></i></button></a>
        

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">x</span>
    <p>We think we have an idea of what you might be looking for.  If you want more accurate results, you can answer more questions.</p> <p>Would you like to continue the questionnaire?</p>
      <center>
      <button class="btn btn-success" onclick="modal.style.display = 'none'";>Yes, I'd like to get more accurate results.</button>
      <a href="results.html"><button class="btn btn-info">No, show me my results now.</button></a>
      </center>
  </div>

</div>
    </body>





</html>
